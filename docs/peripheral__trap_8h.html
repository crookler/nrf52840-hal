<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Embedded from Scratch: peripheral_trap.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Embedded from Scratch
   &#160;<span id="projectnumber">Project</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('peripheral__trap_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">peripheral_trap.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains syscalls that are unique to providing custom peripheral interaction to user-space (all functionality tied to specific peripherals and not generic syscalls)  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="arm_8h_source.html">arm.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for peripheral_trap.h:</div>
<div class="dyncontent">
<div class="center"><img src="peripheral__trap_8h__incl.png" border="0" usemap="#aperipheral__trap_8h" alt=""/></div>
<map name="aperipheral__trap_8h" id="aperipheral__trap_8h">
<area shape="rect" title="Contains syscalls that are unique to providing custom peripheral interaction to user&#45;space (all funct..." alt="" coords="5,5,139,32"/>
<area shape="rect" href="arm_8h.html" title="Macro definitions, typedefs, and aliases for common ARM functionality." alt="" coords="42,80,102,107"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="peripheral__trap_8h__dep__incl.png" border="0" usemap="#aperipheral__trap_8hdep" alt=""/></div>
<map name="aperipheral__trap_8hdep" id="aperipheral__trap_8hdep">
<area shape="rect" title="Contains syscalls that are unique to providing custom peripheral interaction to user&#45;space (all funct..." alt="" coords="69,5,202,32"/>
<area shape="rect" href="peripheral__trap_8c.html" title="Implements syscalls that drive custom peripheral functionality (not standardized)" alt="" coords="5,80,137,107"/>
<area shape="rect" href="syscall_8c.html" title="Implementation of SVC handler allowing for generic software&#45;pended exceptions and select NEWLIB requi..." alt="" coords="161,80,240,107"/>
</map>
</div>
</div>
<p><a href="peripheral__trap_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa98ec3f425bce3ba5c900bd92c643bbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#aa98ec3f425bce3ba5c900bd92c643bbf">syscall_sleep_ms</a> (<a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> ms)</td></tr>
<tr class="separator:aa98ec3f425bce3ba5c900bd92c643bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bf0f39c996ec3f9423cbd37d24da88b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="arm_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#a9bf0f39c996ec3f9423cbd37d24da88b">syscall_lux_read</a> ()</td></tr>
<tr class="separator:a9bf0f39c996ec3f9423cbd37d24da88b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62ab70012cd89d2cb0f3193cca3ffd9f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#a62ab70012cd89d2cb0f3193cca3ffd9f">syscall_neopixel_set</a> (<a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> red, <a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> green, <a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> blue, <a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> pix_index)</td></tr>
<tr class="separator:a62ab70012cd89d2cb0f3193cca3ffd9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b427a652a623c5ab71e1858324a1c99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#a4b427a652a623c5ab71e1858324a1c99">syscall_neopixel_load</a> ()</td></tr>
<tr class="separator:a4b427a652a623c5ab71e1858324a1c99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669a49b03d553683c3348a4f01b4c82e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#a669a49b03d553683c3348a4f01b4c82e">syscall_stepper_set_speed</a> (<a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> rpm)</td></tr>
<tr class="separator:a669a49b03d553683c3348a4f01b4c82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e63416bd1138d7ab3262034f269f8eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#a2e63416bd1138d7ab3262034f269f8eb">syscall_stepper_move_steps</a> (<a class="el" href="arm_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a> steps_to_move)</td></tr>
<tr class="separator:a2e63416bd1138d7ab3262034f269f8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeda6231be2ba4954b8fbf1c0fca64466"><td class="memItemLeft" align="right" valign="top"><a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="peripheral__trap_8h.html#aeda6231be2ba4954b8fbf1c0fca64466">syscall_ultrasonic_read</a> ()</td></tr>
<tr class="separator:aeda6231be2ba4954b8fbf1c0fca64466"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains syscalls that are unique to providing custom peripheral interaction to user-space (all functionality tied to specific peripherals and not generic syscalls) </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a9bf0f39c996ec3f9423cbd37d24da88b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bf0f39c996ec3f9423cbd37d24da88b">&#9670;&nbsp;</a></span>syscall_lux_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arm_8h.html#a273cf69d639a59973b6019625df33e30">uint16_t</a> syscall_lux_read </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>lux_read system call to provide an ambient light measurement to the user.</p>
<p>Takes a measurements on the i2c of the lux sensor. Returns the uint16_t measurement (which is packaged into r0 by Systick_C_Handler) </p>
<p>LSB comes back first</p>

</div>
</div>
<a id="a4b427a652a623c5ab71e1858324a1c99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b427a652a623c5ab71e1858324a1c99">&#9670;&nbsp;</a></span>syscall_neopixel_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syscall_neopixel_load </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>neopixel_load system call acting as a wrapper for the pix_load_sequence function.</p>
<p>Wraps the neopixel_load functionality (indicating for PWM peripheral to begin loading the configured sequence). </p>

</div>
</div>
<a id="a62ab70012cd89d2cb0f3193cca3ffd9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62ab70012cd89d2cb0f3193cca3ffd9f">&#9670;&nbsp;</a></span>syscall_neopixel_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syscall_neopixel_set </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>red</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>green</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="arm_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>&#160;</td>
          <td class="paramname"><em>blue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>pix_index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>neopixel_set system call acting as a wrapper for the neopixel_set function.</p>
<p>Wraps the neopixel_set functionality (passing in red, green, and blue to existing peripheral function). Sets the provided color scheme to <code>pix_index</code> in the internal array of colors. Assumes that the peripheral was initialized by kernel_main. </p>

</div>
</div>
<a id="aa98ec3f425bce3ba5c900bd92c643bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa98ec3f425bce3ba5c900bd92c643bbf">&#9670;&nbsp;</a></span>syscall_sleep_ms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void syscall_sleep_ms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>ms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>sleep_ms system call acting as a wrapper for the systick_delay function.</p>
<p>Actively waits by calling the blocking systick_delay function with <code>ms</code>. </p>

</div>
</div>
<a id="a2e63416bd1138d7ab3262034f269f8eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e63416bd1138d7ab3262034f269f8eb">&#9670;&nbsp;</a></span>syscall_stepper_move_steps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syscall_stepper_move_steps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arm_8h.html#a32f2e37ee053cf2ce8ca28d1f74630e5">int32_t</a>&#160;</td>
          <td class="paramname"><em>steps_to_move</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>stepper_move_steps system call for rotating the stepper motor through a specified number of steps with direction based on sign of steps_to_move (wrapper of move kernel function - blocking)</p>
<p>Wraps the stepper_move kernel level functionality. The kernel level implementation is blocking so that the user space application accurately understands when the motor is again ready to move. Treat the blocking time as work performed by the TIMER0 handler (i.e. still have it be profiled by the motor control task to avoid guessing game). </p>

</div>
</div>
<a id="a669a49b03d553683c3348a4f01b4c82e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a669a49b03d553683c3348a4f01b4c82e">&#9670;&nbsp;</a></span>syscall_stepper_set_speed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int syscall_stepper_set_speed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&#160;</td>
          <td class="paramname"><em>rpm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>stepper_set_speed system call for specifying the RPM of the attach stepper motor (essentially a wrapper of the set_speed kernel function)</p>
<p>Wraps the stepper_speed functionality (passing in rpm from user space to be configured on the global stepper motor). </p>

</div>
</div>
<a id="aeda6231be2ba4954b8fbf1c0fca64466"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeda6231be2ba4954b8fbf1c0fca64466">&#9670;&nbsp;</a></span>syscall_ultrasonic_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="arm_8h.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> syscall_ultrasonic_read </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wrapper for the ultrasonic_read system call that calls ultrasonic_range kernel functionality and returns the measured range (in cm) - blocking</p>
<p>Wraps the ultrasonic_range kenrnel level functionality. The kernel level implementation is blocking so user space can accurately profile how long work takes to get a sensor measurement. Treat the blocking time as work performed by the TIMER1 handler. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_009f605b833ac4622acd6c3c0c26c0f0.html">include</a></li><li class="navelem"><a class="el" href="peripheral__trap_8h.html">peripheral_trap.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
